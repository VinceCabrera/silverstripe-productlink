{"version":3,"sources":["webpack:///webpack/bootstrap 64bd2a13138507a77968","webpack:///external \"Injector\"","webpack:///external \"InsertLinkModal\"","webpack:///external \"ReactDom\"","webpack:///external \"TinyMCEActionRegistrar\"","webpack:///external \"i18n\"","webpack:///external \"jQuery\"","webpack:///./client/src/TinyMCE_sslink-phone.js"],"names":["commandName","TinyMCEActionRegistrar","addAction","text","i18n","_t","onclick","editor","execCommand","priority","addCommandWithUrlTest","plugin","init","addCommand","field","window","jQuery","id","entwine","openLinkPhoneDialog","modalId","sectionConfigKey","formName","InsertLinkPhoneModal","$","dialog","length","append","addClass","setElement","open","renderModal","show","handleHide","close","handleInsert","attrs","getOriginalAttributes","selection","tinymce","activeEditor","selectionContent","getContent","tagName","getNode","requireLinkText","trim","ReactDOM","render","getElement","getEditor","node","getSelectedNode","phone","attr","replace","Link","Description","buildAttributes","data","attributes","_super","href","target","PluginManager","add"],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA,mDAA2C,cAAc;;AAEzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;AChEA,0B;;;;;;ACAA,iC;;;;;;ACAA,0B;;;;;;ACAA,wC;;;;;;ACAA,sB;;;;;;ACAA,wB;;;;;;;;;;;;;ACCA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;AACA;;;;AAEA,IAAMA,cAAc,aAApB;;AAGAC,iCACKC,SADL,CACe,QADf,EACyB;AACjBC,UAAMC,eAAKC,EAAL,CAAQ,uBAAR,EAAiC,sBAAjC,CADW;;AAGjBC,aAAS,iBAACC,MAAD;AAAA,eAAYA,OAAOC,WAAP,CAAmBR,WAAnB,CAAZ;AAAA,KAHQ;AAIjBS,cAAU;AAJO,CADzB,EAOKC,qBAPL,CAO2BV,WAP3B,EAOwC,OAPxC;;AASA,IAAMW,SAAS;AACXC,QADW,gBACNL,MADM,EACE;AACTA,eAAOM,UAAP,CAAkBb,WAAlB,EAA+B,YAAM;AACjC,gBAAMc,QAAQC,OAAOC,MAAP,OAAkBT,OAAOU,EAAzB,EAA+BC,OAA/B,CAAuC,IAAvC,CAAd;;AAEAJ,kBAAMK,mBAAN;AACH,SAJD;AAKH;AAPU,CAAf;;AAUA,IAAMC,UAAU,oCAAhB;AACA,IAAMC,mBAAmB,kCAAzB;AACA,IAAMC,WAAW,iBAAjB;;AAEA,IAAMC,uBAAuB,6BAAc,4CAAsBF,gBAAtB,EAAwCC,QAAxC,CAAd,CAA7B;;AAEAN,iBAAOE,OAAP,CAAe,IAAf,EAAqB,UAACM,CAAD,EAAO;AACxBA,MAAE,qBAAF,EAAyBN,OAAzB,CAAiC;AAC7BC,2BAD6B,iCACP;AAClB,gBAAIM,SAASD,QAAMJ,OAAN,CAAb;;AAEA,gBAAI,CAACK,OAAOC,MAAZ,EAAoB;AAChBD,yBAASD,gBAAcJ,OAAd,UAAT;AACAI,kBAAE,MAAF,EAAUG,MAAV,CAAiBF,MAAjB;AACH;AACDA,mBAAOG,QAAP,CAAgB,6BAAhB;;AAEAH,mBAAOI,UAAP,CAAkB,IAAlB;AACAJ,mBAAOK,IAAP;AACH;AAZ4B,KAAjC;;AAkBAN,YAAMJ,OAAN,EAAiBF,OAAjB,CAAyB;AACrBa,mBADqB,uBACTC,IADS,EACH;AAAA;;AACd,gBAAMC,aAAa,SAAbA,UAAa;AAAA,uBAAM,MAAKC,KAAL,EAAN;AAAA,aAAnB;AACA,gBAAMC,eAAe,SAAfA,YAAe;AAAA,uBAAa,MAAKA,YAAL,wBAAb;AAAA,aAArB;AACA,gBAAMC,QAAQ,KAAKC,qBAAL,EAAd;AACA,gBAAMC,YAAYC,QAAQC,YAAR,CAAqBF,SAAvC;AACA,gBAAMG,mBAAmBH,UAAUI,UAAV,MAA0B,EAAnD;AACA,gBAAMC,UAAUL,UAAUM,OAAV,GAAoBD,OAApC;AACA,gBAAME,kBAAkBF,YAAY,GAAZ,IAAmBF,iBAAiBK,IAAjB,OAA4B,EAAvE;;AAGAC,+BAASC,MAAT,CACI,oBAAC,oBAAD;AACA,sBAAMhB,IADN;AAEA,0BAAUG,YAFV;AAGA,wBAAQF,UAHR;AAIA,uBAAO7B,eAAKC,EAAL,CAAQ,kBAAR,EAA4B,0BAA5B,CAJP;AAKA,+BAAc,eALd;AAMA,2BAAU,oCANV;AAOA,gCAAgB+B,KAPhB;AAQA,4BAAW,4BARX;AASA,iCAAiBS;AATjB,cADJ,EAYI,KAAK,CAAL,CAZJ;AAeH,SA1BoB;AA4BrBR,6BA5BqB,mCA4BG;AACpB,gBAAM9B,SAAS,KAAK0C,UAAL,GAAkBC,SAAlB,EAAf;AACA,gBAAMC,OAAO3B,EAAEjB,OAAO6C,eAAP,EAAF,CAAb;;AAEA,gBAAIC,QAAQ,CAACF,KAAKG,IAAL,CAAU,MAAV,KAAqB,EAAtB,EAA0BC,OAA1B,CAAkC,OAAlC,EAA2C,EAA3C,CAAZ;;AAEA,mBAAO;AACHC,sBAAMH,KADH;AAEHI,6BAAaN,KAAKG,IAAL,CAAU,OAAV;AAFV,aAAP;AAIH,SAtCoB;AAwCrBI,uBAxCqB,2BAwCLC,IAxCK,EAwCC;AAClB,gBAAMC,aAAa,KAAKC,MAAL,CAAYF,IAAZ,CAAnB;;AAEA,gBAAIG,OAAO,EAAX;;AAEA,gBAAIT,QAAQO,WAAWE,IAAX,CAAgBP,OAAhB,CAAwB,OAAxB,EAAiC,EAAjC,CAAZ;;AAEA,gBAAIF,KAAJ,EAAW;AACPS,gCAAcT,KAAd;AACH;AACDO,uBAAWE,IAAX,GAAkBA,IAAlB;;AAEA,mBAAOF,WAAWG,MAAlB;;AAEA,mBAAOH,UAAP;AACH;AAvDoB,KAAzB;AAyDH,CA5ED;;AA+EArB,QAAQyB,aAAR,CAAsBC,GAAtB,CAA0BjE,WAA1B,EAAuC,UAACO,MAAD;AAAA,WAAYI,OAAOC,IAAP,CAAYL,MAAZ,CAAZ;AAAA,CAAvC;kBACeI,M","file":"js/TinyMCE_sslink-phone.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 6);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 64bd2a13138507a77968","module.exports = Injector;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"Injector\"\n// module id = 0\n// module chunks = 0","module.exports = InsertLinkModal;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"InsertLinkModal\"\n// module id = 1\n// module chunks = 0","module.exports = ReactDom;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"ReactDom\"\n// module id = 2\n// module chunks = 0","module.exports = TinyMCEActionRegistrar;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"TinyMCEActionRegistrar\"\n// module id = 3\n// module chunks = 0","module.exports = i18n;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"i18n\"\n// module id = 4\n// module chunks = 0","module.exports = jQuery;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jQuery\"\n// module id = 5\n// module chunks = 0","/* global tinymce, window */\nimport i18n from 'i18n';\nimport TinyMCEActionRegistrar from 'lib/TinyMCEActionRegistrar';\nimport ReactDOM from 'react-dom';\nimport jQuery from 'jquery';\nimport {createInsertLinkModal} from 'containers/InsertLinkModal/InsertLinkModal';\nimport {loadComponent} from 'lib/Injector';\n\nconst commandName = 'sslinkphone';\n\n// Link to phone number\nTinyMCEActionRegistrar\n    .addAction('sslink', {\n        text: i18n._t('Admin.LINKLABEL_PHONE', 'Link to phone number'),\n        // eslint-disable-next-line no-console\n        onclick: (editor) => editor.execCommand(commandName),\n        priority: 51,\n    })\n    .addCommandWithUrlTest(commandName, /^tel:/);\n\nconst plugin = {\n    init(editor) {\n        editor.addCommand(commandName, () => {\n            const field = window.jQuery(`#${editor.id}`).entwine('ss');\n\n            field.openLinkPhoneDialog();\n        });\n    },\n};\n\nconst modalId = 'insert-link__dialog-wrapper--phone';\nconst sectionConfigKey = 'SilverStripe\\\\Admin\\\\LeftAndMain';\nconst formName = 'EditorPhoneLink';\n\nconst InsertLinkPhoneModal = loadComponent(createInsertLinkModal(sectionConfigKey, formName));\n\njQuery.entwine('ss', ($) => {\n    $('textarea.htmleditor').entwine({\n        openLinkPhoneDialog() {\n            let dialog = $(`#${modalId}`);\n\n            if (!dialog.length) {\n                dialog = $(`<div id=\"${modalId}\" />`);\n                $('body').append(dialog);\n            }\n            dialog.addClass('insert-link__dialog-wrapper');\n\n            dialog.setElement(this);\n            dialog.open();\n        },\n    });\n\n    /**\n     * Assumes that $('.insert-link__dialog-wrapper').entwine({}); is defined for shared functions\n     */\n    $(`#${modalId}`).entwine({\n        renderModal(show) {\n            const handleHide = () => this.close();\n            const handleInsert = (...args) => this.handleInsert(...args);\n            const attrs = this.getOriginalAttributes();\n            const selection = tinymce.activeEditor.selection;\n            const selectionContent = selection.getContent() || '';\n            const tagName = selection.getNode().tagName;\n            const requireLinkText = tagName !== 'A' && selectionContent.trim() === '';\n            \n            // create/update the react component\n            ReactDOM.render(\n                <InsertLinkPhoneModal\n                show={show}\n                onInsert={handleInsert}\n                onHide={handleHide}\n                title={i18n._t('Admin.LINK_PHONE', 'Insert phone number link')}\n                bodyClassName=\"modal__dialog\"\n                className=\"insert-link__dialog-wrapper--phone\"\n                fileAttributes={attrs}\n                identifier=\"Admin.InsertLinkPhoneModal\"\n                requireLinkText={requireLinkText}\n                />,\n                this[0]\n            );\n\n        },\n\n        getOriginalAttributes() {\n            const editor = this.getElement().getEditor();\n            const node = $(editor.getSelectedNode());\n\n            let phone = (node.attr('href') || '').replace(/^tel:/, '');\n\n            return {\n                Link: phone,\n                Description: node.attr('title'),\n            };\n        },\n\n        buildAttributes(data) {\n            const attributes = this._super(data);\n\n            let href = '';\n\n            let phone = attributes.href.replace(/^tel:/, '');\n\n            if (phone) {\n                href = `tel:${phone}`;\n            }\n            attributes.href = href;\n\n            delete attributes.target;\n\n            return attributes;\n        },\n    });\n});\n\n// Adds the plugin class to the list of available TinyMCE plugins\ntinymce.PluginManager.add(commandName, (editor) => plugin.init(editor));\nexport default plugin;\n\n\n// WEBPACK FOOTER //\n// ./client/src/TinyMCE_sslink-phone.js"],"sourceRoot":""}